---
tags:
  - monitoring
---
---

# Описание  

**Prometheus** — это система мониторинга и оповещения с открытым исходным кодом, разработанная для надежного сбора метрик и их анализа в реальном времени. Используется для наблюдения за производительностью распределенных систем, микросервисов и контейнеров.  

## Инструменты  
- Prometheus Server (сбор и хранение метрик)  
- PromQL (язык запросов)  
- Alertmanager (управление оповещениями)  
- [[Grafana]] (визуализация метрик)  
- Pushgateway (для кратковременных задач)  
- Экспортеры (Node Exporter, Blackbox Exporter и др.)  

## Связь с другими навыками  

| Технология | Взаимодействие |  
| ---------- | -------------- |  
| Kubernetes | Мониторинг кластеров и подов |  
| Docker | Сбор метрик контейнеров |  
| [[Grafana]] | Визуализация данных Prometheus |  
| OpenMetrics | Стандарт формата метрик |  
| Thanos/Cortex | Масштабируемое долгосрочное хранение |  

## Архитектура и основные понятия  
- **Метрика** — числовое измерение состояния системы (CPU, память, запросы и т. д.).  
- **Экспортер** — сервис, предоставляющий метрики в формате Prometheus.  
- **Scrape** — процесс сбора метрик Prometheus с целевых endpoints.  
- **TSDB** (Time Series Database) — база данных временных рядов для хранения метрик.  
- **Alerting Rules** — правила для генерации алертов на основе метрик.  
- **Service Discovery** — автоматическое обнаружение целей для мониторинга (Kubernetes, Consul и др.).  

---

# Практика  

## Оценка уровня навыка  

| Уровень | Описание | Ключевые навыки | Критерии оценки |  
| ------- | -------- | --------------- | --------------- |  
| **Junior** | Базовое развертывание и настройка | Установка Prometheus, написание простых запросов PromQL | Умение настраивать сбор метрик и создавать дашборды в [[Grafana]] |  
| **Middle** | Глубокая настройка и оптимизация | Настройка алертов, работа с экспортерами, оптимизация запросов | Опыт мониторинга production-систем, использование Service Discovery |  
| **Senior** | Масштабирование и кастомизация | Настройка долгосрочного хранения (Thanos/Cortex), кастомизация экспортеров | Умение проектировать отказоустойчивые системы мониторинга |  
| **Expert** | Разработка расширений и глубокий анализ | Модификация кода Prometheus, оптимизация TSDB, анализ performance issues | Участие в разработке Prometheus или связанных OSS-проектов |  

## Бизнес-ценность и использование в работе  

| Применение | Описание | Преимущества | Рекомендации по использованию |  
| ---------- | -------- | ------------ | ----------------------------- |  
| **Мониторинг инфраструктуры** | Отслеживание серверов, сети, хранилищ | Быстрое выявление аномалий | Использовать Node Exporter для системных метрик |  
| **Наблюдение за микросервисами** | Анализ задержек, ошибок, нагрузки | Улучшение отказоустойчивости | Интегрировать с [[Istio]]/Envoy для трейсинга |  
| **Оповещения о проблемах** | Автоматические алерты при критических состояниях | Снижение времени реакции на инциденты | Настраивать разумные thresholds и группировку в Alertmanager |  

## Pet-project  

| Уровень | Название проекта | Описание | Технологии | Критерий успеха | Вспомогательные ссылки |  
| ------- | ---------------- | -------- | ---------- | --------------- | ---------------------- |  
| **Junior** | Мониторинг домашнего сервера | Сбор метрик CPU, памяти, диска | Prometheus, Node Exporter, [[Grafana]] | Стабильный сбор данных | Официальная документация Prometheus |  
| **Middle** | Мониторинг веб-приложения | Трекинг HTTP-запросов, ошибок, latency | Prometheus, Blackbox Exporter, Alertmanager | Настройка алертов при 5xx ошибках | Примеры конфигов на GitHub |  
| **Senior** | Распределенный мониторинг Kubernetes | Мультикластерный мониторинг с долгосрочным хранением | Prometheus, Thanos, [[Grafana]] | Единая точка доступа к метрикам | Документация Thanos |  
| **Expert** | Кастомный экспортер для специфичного ПО | Сбор метрик с кастомного enterprise-решения | Go, Prometheus Client Library | Поддержка сложных метрик | Исходники официальных экспортеров |  

## Траблшутинг  
- **Проблема**: Высокая нагрузка на Prometheus  
  **Решение**: Оптимизировать частоту сбора (scrape_interval), фильтровать ненужные метрики (metric_relabel_configs).  
- **Проблема**: Пропуск данных при перезапуске  
  **Решение**: Настроить WAL (Write-Ahead Log) и увеличить retention.  
- **Проблема**: Ложные алерты  
  **Решение**: Настроить группировку и задержки в Alertmanager (group_wait, group_interval).  

## Ресурсы, форумы  
- Официальная документация Prometheus  
- Prometheus Community Slack  
- Конференции PromCon  
- GitHub-репозитории (prometheus, thanos, [[grafana]])  
- Stack Overflow (тэги #prometheus, #promql)