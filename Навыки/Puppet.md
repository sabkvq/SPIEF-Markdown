---
tags:
  - iac_automation
---
# Puppet

## Описание

Puppet — это система управления конфигурациями, предназначенная для автоматизации настройки и управления большим парком машин. Она позволяет централизованно описывать и поддерживать состояние серверов и рабочих станций, приводя их к нужному конфигурационному состоянию и поддерживая его в дальнейшем. Puppet написан на Ruby и имеет клиент-серверную архитектуру, где на каждом управляемом узле установлен агент, который периодически (обычно раз в полчаса) обращается к серверу за обновлениями конфигурации.

Конфигурация описывается на специальном декларативном языке, основанном на понятии ресурсов — базовых элементов, которые имеют тип, атрибуты и имя. Ресурсы можно группировать в классы, а классы — использовать для описания функциональности узлов (node), например, «веб-сервер» или «офисный десктоп». Язык поддерживает многие возможности объектно-ориентированного программирования, что делает описание конфигураций понятным и удобным для сопровождения.

Puppet обеспечивает идемпотентность — повторное применение конфигурации не приводит к нежелательным изменениям, а только поддерживает заданное состояние. Также Puppet кроссплатформенный и поддерживает множество операционных систем и облачных платформ.

## Инструменты

- Puppet Master (сервер) — хранит и распространяет конфигурации.
- Puppet Agent (клиент) — установлен на управляемых узлах, применяет конфигурации.
- Puppet DSL — язык описания конфигураций.
- Манифесты — файлы с описанием конфигураций.
- Модули — наборы классов и ресурсов для повторного использования.
- Puppet Forge — репозиторий готовых модулей сообщества.
- Интеграция с Git, Jenkins, Docker и другими DevOps-инструментами.

## Связь с другими навыками

| Технология | Взаимодействие |
| ---------- | -------------- |
| Git        | Хранение и версионирование манифестов и модулей Puppet |
| Jenkins    | Автоматизация запуска Puppet и CI/CD процессов |
| Docker     | Управление конфигурацией контейнеров и хостов |
| Linux     | Основная платформа для установки Puppet и управления ОС |
| Ruby       | Язык, на котором написан Puppet, используется для расширения функционала |
| Ansible   | Альтернативный инструмент управления конфигурациями с push-моделью |

## Архитектура и основные понятия

- **Клиент-серверная модель**: Puppet Master хранит конфигурации, Puppet Agent на узлах запрашивает и применяет их.
- **Ресурсы**: базовые единицы конфигурации (файлы, пакеты, сервисы и т.д.).
- **Классы и модули**: группировка ресурсов для удобства управления.
- **Узлы (nodes)**: описание конфигурации для определённых типов машин.
- **Идемпотентность**: конфигурация применяется без нежелательных изменений при повторных запусках.
- **TLS-шифрование**: защищённое взаимодействие между сервером и агентами.
- **Пулл-модель**: агенты сами запрашивают конфигурацию у сервера по расписанию.

## Практика

### Оценка уровня навыка

| Уровень | Описание                                | Ключевые навыки                            | Критерии оценки                                    |
| ------- | ------------------------------------- | ----------------------------------------- | ------------------------------------------------- |
| Junior  | Знаком с основами Puppet и его архитектурой | Создание простых манифестов, запуск агента | Может описать и применить базовую конфигурацию    |
| Middle  | Управляет конфигурациями для нескольких узлов | Группировка ресурсов в классы, работа с модулями | Настраивает классы, использует Puppet Forge       |
| Senior  | Автоматизирует сложные инфраструктуры | Управление зависимостями, интеграция с CI/CD | Настраивает масштабируемые решения, отлаживает конфигурации |
| Expert  | Разрабатывает кастомные расширения Puppet | Глубокое понимание внутренней архитектуры и языка | Создаёт собственные типы ресурсов, ведёт крупные проекты |

### Бизнес-ценность и использование в работе

| Применение           | Описание                                         | Преимущества                                | Рекомендации по использованию                   |
| -------------------- | ------------------------------------------------ | ------------------------------------------- | ----------------------------------------------- |
| Автоматизация настройки | Централизованное управление конфигурациями сотен и тысяч машин | Экономия времени, снижение ошибок          | Использовать для стандартизации и контроля      |
| Поддержание состояния | Обеспечение идемпотентности и стабильности конфигураций | Минимизация сбоев и простоев                | Регулярно применять Puppet, мониторить состояние |
| Управление зависимостями | Контроль порядка применения ресурсов и сервисов | Корректное развертывание сложных систем    | Использовать зависимости и уведомления          |
| Интеграция DevOps     | Встраивание в CI/CD процессы и автоматизация релизов | Ускорение доставки и повышение качества    | Интегрировать с Jenkins, Git и Docker            |

### Pet-project

| Уровень    | Название проекта         | Описание                                    | Технологии         | Критерий успеха                      | Вспомогательные ссылки               |
| ---------- | ----------------------- | ------------------------------------------- | ------------------ | ---------------------------------- | ---------------------------------- |
| Junior     | Автоматизация настройки  | Создание манифеста для установки Apache     | Puppet, Linux      | Успешная установка и запуск сервиса | Habr, Puppet Forge                  |
| Middle     | Управление веб-серверами | Организация классов и модулей для Nginx     | Puppet, Git        | Масштабируемое управление конфигурациями | Habr, официальная документация     |
| Senior     | CI/CD интеграция         | Настройка автоматического применения конфигураций через Jenkins | Puppet, Jenkins    | Автоматизация релизов               | Документация Jenkins и Puppet       |
| Expert     | Кастомные ресурсы        | Разработка собственных типов ресурсов и функций Puppet | Ruby, Puppet API   | Расширение функционала Puppet       | Puppet Developer Guides             |

## Траблшутинг

- Проверка логов агента и сервера для выявления ошибок.
- Отладка манифестов с помощью `puppet apply` в локальном режиме.
- Управление сертификатами TLS для безопасного соединения.
- Использование `puppet resource` для диагностики текущего состояния ресурсов.
- Восстановление предыдущих конфигураций при ошибках.

## Ресурсы, форумы

- Habr — статьи и руководства по Puppet  
- Официальная документация Puppet  
- Puppet Forge — репозиторий модулей  
- Stack Overflow — вопросы и ответы по Puppet  
- YouTube — обучающие видео и демонстрации  
- Сообщества и форумы системных администраторов

---
